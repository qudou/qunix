# 中断

8086PC 机可以表示 256 种中断信息的来源。

中断向量表指定放在内存地址 0 处，在内存 0000:0000 到 0000:03FF 的 1024 个单元中存放。

中断可分为内中断与外中断

## 内中断

1 除法错误，0
2 单步执行，1
3 执行 into 指令，4
4 执行 int 指令，n

中断过程：

1 取得中断类型码 N
2 pushf
3 TF=0, IF=0 (禁止单步和可屏蔽中断)
4 push CS
5 push IP
6 (IP)=(N*4), (CS)=(N*4+2)

## 外中断

外中断又分为可屏蔽中断和不可屏蔽中断。可屏蔽中断过程和内中断类似。

不可屏蔽中断，中断类型码固定为 2，其中断过程如下

1 pushf
2 TF=0, IF=0 (禁止单步和可屏蔽中断)
3 push CS
4 push IP
5 (IP)=(8), (CS)=(0AH)

## 指令

sti

设置 IF=1

cli

设置 IF=0

iret

该指令相当于如下指令集

pop IP
pop CS
popf

该指令通常与 int 指令配合使用

pushf

将标志寄存器的值压栈

popf

从栈中弹出数据，送入标志寄存器中

cld
	
将标志寄存器的 df 位置 0	

std

将标志寄存器的 df 位置 1

movesb

move es:[di],byte ptr ds:[si]
df = 0	inc si	inc di
df = 1	dec si	dec di

movsw

move es:[di],word ptr ds:[si]
df = 0	add si,2 add di,2
df = 1	sub si,2 sub di,2

rep movsb

s:movsb
  loop s	

rep movsw

s:movsw		
  loop s
